<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Tutorial · NeuralDynamics.jl</title><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.039/juliamono-regular.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.11/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../"><img class="docs-light-only" src="../assets/logo.svg" alt="NeuralDynamics.jl logo"/><img class="docs-dark-only" src="../assets/logo-dark.svg" alt="NeuralDynamics.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../">NeuralDynamics.jl</a></span></div><form class="docs-search" action="../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li class="is-active"><a class="tocitem" href>Tutorial</a><ul class="internal"><li><a class="tocitem" href="#Initialize-model"><span>Initialize model</span></a></li><li><a class="tocitem" href="#Find-nullclines"><span>Find nullclines</span></a></li><li><a class="tocitem" href="#Find-fixed-points"><span>Find fixed points</span></a></li><li><a class="tocitem" href="#Find-fixed-point-stability-numerically"><span>Find fixed point stability numerically</span></a></li><li><a class="tocitem" href="#Observe-vector-fields"><span>Observe vector fields</span></a></li><li><a class="tocitem" href="#Simulate-data"><span>Simulate data</span></a></li><li><a class="tocitem" href="#Simulations-in-time-domain"><span>Simulations in time domain</span></a></li><li><a class="tocitem" href="#Remarks"><span>Remarks</span></a></li></ul></li><li><a class="tocitem" href="../models/">Models</a></li><li><a class="tocitem" href="../functions/">Function Documentation</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Tutorial</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Tutorial</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/neuro-myoung/NeuralDynamics.jl/blob/master/docs/src/tutorial.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="Tutorial"><a class="docs-heading-anchor" href="#Tutorial">Tutorial</a><a id="Tutorial-1"></a><a class="docs-heading-anchor-permalink" href="#Tutorial" title="Permalink"></a></h1><p>Here I give an example of an analysis workflow showcasing some of the convenience functions built into this package by looking at a Wilson-Cowan network model. </p><h2 id="Initialize-model"><a class="docs-heading-anchor" href="#Initialize-model">Initialize model</a><a id="Initialize-model-1"></a><a class="docs-heading-anchor-permalink" href="#Initialize-model" title="Permalink"></a></h2><hr/><p>Begin by loading the pacakge along with Plots so we can visualize our work.</p><pre><code class="nohighlight hljs">using NeuralDyanmics, Plots</code></pre><p>We will then be able to instantiate our model. Custom models can be built but since the Wilson-Cowan model is built in we can simply call the default parameters and the model equations as follows:</p><pre><code class="nohighlight hljs">julia&gt; params = initializeParams(&quot;WC&quot;)
Dict{Symbol, Float64} with 12 entries:
    :tauE   =&gt; 1.0
    :wEE    =&gt; 9.0
    :wIE    =&gt; 13.0
    :thetaE =&gt; 2.8
    :wEI    =&gt; 4.0
    :wII    =&gt; 11.0
    :tauI   =&gt; 2.0
    :aE     =&gt; 1.2
    :aI     =&gt; 1.0
    :II     =&gt; 0.0
    :thetaI =&gt; 4.0
    :IE     =&gt; 0.0

julia&gt; mdl = modelEquations(&quot;WC&quot;)
modelEquations(&quot;WC&quot;, (NeuralDynamics.wc_drₑ, NeuralDynamics.wc_drᵢ), (NeuralDynae, NeuralDynamics.wc_iNullcline))</code></pre><h2 id="Find-nullclines"><a class="docs-heading-anchor" href="#Find-nullclines">Find nullclines</a><a id="Find-nullclines-1"></a><a class="docs-heading-anchor-permalink" href="#Find-nullclines" title="Permalink"></a></h2><hr/><p>Above I have shown the output to give you some idea of these structures that are used throughout the majority of this package. We may like to begin by exploring our model in the phase plane. The equations for the nullclines can be found in our modelEquations as we can see by typing the following:</p><pre><code class="nohighlight hljs">julia&gt; mdl.nullclines
(NeuralDynamics.wc_eNullcline, NeuralDynamics.wc_iNullcline)</code></pre><p>Thus, we can define the space we would like to observe and call the function <code>getNullclines</code> and plot the output to visualize our nullclines in the phase plane.</p><pre><code class="nohighlight hljs">rₑNull = collect(-0.01:0.001:0.96)
rᵢNull = collect(-0.01:0.001:0.8)
ncls = getNullclines(rₑNull, rᵢNull, mdl, params)

plot(rₑNull, ncls[1], xlab=&quot;rₑ&quot;, ylab=&quot;rᵢ&quot;, label=&quot;E Nullcline&quot;, linewidth=2, legend=:topleft)
plot!(ncls[2], rᵢNull, label=&quot;I Nullcline&quot;, linewidth=2)</code></pre><p><img src="../assets/wc_ncls.svg" alt="nullclines"/></p><h2 id="Find-fixed-points"><a class="docs-heading-anchor" href="#Find-fixed-points">Find fixed points</a><a id="Find-fixed-points-1"></a><a class="docs-heading-anchor-permalink" href="#Find-fixed-points" title="Permalink"></a></h2><hr/><p>We see that our model has three fixed points so our next step may be to numerically estimate the locations of these fixed points. For this we can call the <code>findfixedpoints</code> function. This function will need to be supplied with some initial guesses which we can visually determine from the previous plot. We will also use the helper function fWC! here and visualize the fixed points on the previous plot.</p><pre><code class="nohighlight hljs">fps = findFixedPoints(guesses, fWC!, params)
for coord in fps
	dispVal = round.(coord, digits=2)
	scatter!([coord[1]], [coord[2]], color=:black, markersize=8,
		legend=:none)
	annotate!([coord[1]], [coord[2]+0.1], text(&quot;$dispVal&quot;))
end</code></pre><p><img src="../assets/wc_fps.svg" alt="fixedPoints"/></p><h2 id="Find-fixed-point-stability-numerically"><a class="docs-heading-anchor" href="#Find-fixed-point-stability-numerically">Find fixed point stability numerically</a><a id="Find-fixed-point-stability-numerically-1"></a><a class="docs-heading-anchor-permalink" href="#Find-fixed-point-stability-numerically" title="Permalink"></a></h2><hr/><p>Now that we have our fixed points we may be interested in which of these fixed points were stable. This can be tested numerically by checking the eigenvalues of the Jacobian matrix describing our system. If any of the real components for a given point are positive then that fixed point is unstable. For this we will use the <code>getJacobianEigenvalues</code> function and check the results.</p><pre><code class="nohighlight hljs">getJacobianEigenvalues(fps, params)
3-element Vector{Any}:
ComplexF64[-0.6233838572258439 - 0.1311095729053099im, -0.6233838572258439 + 0.1311095729053099im]
[-0.8726689790568727, 1.057207976436168]
[-1.4219741349895596, -0.95956219494619]</code></pre><p>Checking this we see that our second fixpoint is unstable and the other two are stable. </p><h2 id="Observe-vector-fields"><a class="docs-heading-anchor" href="#Observe-vector-fields">Observe vector fields</a><a id="Observe-vector-fields-1"></a><a class="docs-heading-anchor-permalink" href="#Observe-vector-fields" title="Permalink"></a></h2><hr/><p>Alternatively, or as a complementary approach we may wish to visualize the behavior of the system. One way we may do this is by plotting the vector fields on top of our original plot of the nullclines. First we call the function <code>getVectorFields</code> and we input these results into the convenience plotting function <code>plotVectorFields!</code>. Notice the <code>!</code> at the end of this function. This means that this function is ment to modify an existing plot and not generate a new plot on its own.</p><pre><code class="nohighlight hljs">eiArr = 0:0.05:1
fields = getVectorFields(eiArr, wc2, params, subdivisions=15)

plot(rₑNull, ncls[1], xlab=&quot;rₑ&quot;, ylab=&quot;rᵢ&quot;, label=&quot;E Nullcline&quot;, 							linewidth=2, legend=:outertopright)
plot!(ncls[2], rᵢNull, label=&quot;I Nullcline&quot;, linewidth=2)
plotVectorFields!(eiArr, fields, color =:teal, alpha=0.2)</code></pre><p><img src="../assets/wc_vfs.svg" alt="vectorFields"/></p><p>Notice that we supplied an array that defines the space over which we want to generate our field lines. Further, we supplied the optional argument subdivisions that will define the granularity of the sampling of this space. The default value is 10 which would result in a 10x10 grid of field lines. Here, we generated a 15x15 grid. </p><h2 id="Simulate-data"><a class="docs-heading-anchor" href="#Simulate-data">Simulate data</a><a id="Simulate-data-1"></a><a class="docs-heading-anchor-permalink" href="#Simulate-data" title="Permalink"></a></h2><hr/><p>It is still difficult to predict the behavior from visualizing the field lines alone. It may be advantageous to pick initial conditions in phase space and simulate the behavior of the system using the function <code>simulate</code>.</p><pre><code class="nohighlight hljs">## Simulate with different initial conditions
rₑ3, rᵢ3 = simulate(0:0.1:50, &quot;WC&quot;, params, (0.6,0.8))
rₑ4, rᵢ4 = simulate(0:0.1:50, &quot;WC&quot;, params, (0.6,0.6))</code></pre><p>We can then visualize these simulations by plotting them using the function <code>plotTrajectory!</code>. </p><pre><code class="nohighlight hljs">plotTrajectory!(rₑ3, rᵢ3, color=:orange, label=&quot;Sample trajectory: \nlow activity&quot;, markersize=10, linewidth=2, markerstrokewidth=0)
plotTrajectory!(rₑ4, rᵢ4, color=:purple, label=&quot;Sample trajectory: \nhigh activity&quot;, markersize=10, linewidth=2, markerstrokewidth=0)</code></pre><p><img src="../assets/wc_sim1.svg" alt="sample simulations"/></p><p>Interestingly, and perhaps unsurprisingly based on our numerical results we see here that each simulation converges to one of the two stable fixed points we found earlier.</p><p>We may wish to sample more of the phase space in our simulations. I will remove the vector fields here for clarity but we can call the function <code>plotTrajectories!</code>. Unlike plotTrajectory the simulation is built into this function. We must simply define a set of coordinates from which to seed these simulations. Here I&#39;ll use the vector <code>sampleSpace</code> to define that granularity and will reset the plot to simply show these simulations on top of the nullclines for clarity.</p><pre><code class="nohighlight hljs">sampleSpace = 0.0:0.2:1

plot(rₑNull, ncls[1], xlab=&quot;rₑ&quot;, ylab=&quot;rᵢ&quot;, label=&quot;E Nullcline&quot;, 							linewidth=2, legend=:outertopright)
plot!(ncls[2], rᵢNull, label=&quot;I Nullcline&quot;, linewidth=2)
plotTrajectories!(0:0.1:50, sampleSpace, sampleSpace, &quot;WC&quot;, params, color=:gray, label=&quot;Sample Trajectories&quot;, alpha=0.5)</code></pre><p><img src="../assets/wc_sim2.png" alt="sample simulations2"/></p><p>This further cements the idea that our central fixed point is likely unstable (at least at the granularity we have sampled). We can see that all our simulations converge on either of the two stable fixed points we found earlier.</p><h2 id="Simulations-in-time-domain"><a class="docs-heading-anchor" href="#Simulations-in-time-domain">Simulations in time domain</a><a id="Simulations-in-time-domain-1"></a><a class="docs-heading-anchor-permalink" href="#Simulations-in-time-domain" title="Permalink"></a></h2><hr/><p>While phase space can be informative we lose information about the behavior of our system in time. Here, I will show the same system under a different set of initial conditions in both phase space and in the time domain. </p><pre><code class="nohighlight hljs">params = initializeParams(&quot;WC&quot;;wEE=6.4, wEI=4.8, wIE=6.0, wII=1.2, IE=0.8, tauI=2.0)

ncls = getNullclines(rₑNull, rᵢNull, mdl, params)
fields = getVectorFields(eiArr, mdl, params)

l3 = @layout [a b]

pWC3 = plot(rₑNull, ncls[1], xlab=&quot;rₑ&quot;, ylab=&quot;rᵢ&quot;, label=&quot;E Nullcline&quot;, 							linewidth=2, legend=:none)
plot!(ncls[2], rᵢNull, label=&quot;I Nullcline&quot;, linewidth=2)
plotVectorFields!(eiArr, fields, color =:teal, alpha=0.3)
plotTrajectories!(0:0.1:100, sampleSpace2, sampleSpace2, &quot;WC&quot;, params4, color=:gray, label=&quot;Sample Trajectories&quot;, alpha=0.5)

pWC3Activity = plot(0:0.1:100, rₑ8, label=&quot;E population&quot;, color=:blue, ylim=(0,1))
plot!(0:0.1:100, rᵢ8, label=&quot;I population&quot;, color=:red) 

plot(pWC3, pWC3Activity, layout=l3)</code></pre><p><img src="../assets/wc_sim3.png" alt="sample simulations3"/></p><p>Much of the code above is dedicated to styling the plots you can learn more about this by looking at the documentation for Plots.jl. As you can see however the workflow for analyzing the dynamical systems is relatively simple.</p><p>Under these initial conditions we see that our system appears to fall into a stable limit cycle and in the time domain we see tonic spiking activity!</p><h2 id="Remarks"><a class="docs-heading-anchor" href="#Remarks">Remarks</a><a id="Remarks-1"></a><a class="docs-heading-anchor-permalink" href="#Remarks" title="Permalink"></a></h2><hr/><p>I hope this tutorial was clear and please reach out if you have any questions or suggestions. </p><p>If you would like some more examples there are a number of Pluto notebooks attached to the repository that allow for interactive exploration of this example and others.</p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../">« Home</a><a class="docs-footer-nextpage" href="../models/">Models »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.5 on <span class="colophon-date" title="Monday 9 August 2021 15:13">Monday 9 August 2021</span>. Using Julia version 1.6.2.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
